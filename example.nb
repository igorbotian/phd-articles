(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      8249,        221]
NotebookOptionsPosition[      8013,        208]
NotebookOutlinePosition[      8349,        223]
CellTagsIndexPosition[      8306,        220]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"A", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     SubscriptBox["x", "3"], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"B", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "3"], "}"}], ",", 
    RowBox[{"{", 
     SubscriptBox["x", "1"], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"A", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "\[Equal]", " ", "1"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[Mu]", 
      RowBox[{"i", ",", "j"}]], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"B", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", 
       RowBox[{"i", ",", "j"}]], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "+", " ", 
     RowBox[{
      SubscriptBox["\[Mu]", 
       RowBox[{"i", ",", "j"}]], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K", "[", 
   RowBox[{"x_", ",", " ", "y_"}], "]"}], " ", ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "x", "]"}], " ", "\[Equal]", " ", "1"}], ",", " ", 
    RowBox[{"\[Kappa]", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"\[Kappa]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "+", " ", 
     RowBox[{"\[Kappa]", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"y", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KK", "[", 
   RowBox[{"x1_", ",", "z1_", ",", "x2_", ",", "z2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"K", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}], "-", 
   RowBox[{"K", "[", 
    RowBox[{"x1", ",", "z2"}], "]"}], "-", 
   RowBox[{"K", "[", 
    RowBox[{"z1", ",", "x2"}], "]"}], "+", 
   RowBox[{"K", "[", 
    RowBox[{"z1", ",", "z2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"L1", "=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{"i", ",", " ", "j"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"Length", "[", "B", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"L2", "=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"M", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "\[IndentingNewLine]", "*", 
     RowBox[{"M", "[", 
      RowBox[{"r", ",", "t"}], "]"}], "\[IndentingNewLine]", "*", 
     RowBox[{"KK", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       RowBox[{"A", "[", 
        RowBox[{"[", "r", "]"}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "B", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"r", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "B", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"L", "=", 
  RowBox[{"L1", "-", "L2"}]}]}], "Input",
 CellChangeTimes->{{3.608609492447257*^9, 3.608609578738926*^9}, {
   3.60860976037635*^9, 3.608609796192621*^9}, {3.608609852985362*^9, 
   3.608609854336778*^9}, {3.608610173609228*^9, 3.608610174592558*^9}, {
   3.60861022700071*^9, 3.608610255335726*^9}, {3.608610298793096*^9, 
   3.608610374275962*^9}, {3.608610424881056*^9, 3.60861045147261*^9}, {
   3.608610483979236*^9, 3.608610514282135*^9}, {3.608610547411004*^9, 
   3.608610559552672*^9}, {3.608610614730062*^9, 3.608610670876114*^9}, {
   3.608611109780048*^9, 3.608611128076033*^9}, {3.608611165451867*^9, 
   3.608611242459446*^9}, {3.608611369724131*^9, 3.608611377802399*^9}, {
   3.608611413244849*^9, 3.6086114137869*^9}, {3.608611490331745*^9, 
   3.608611492395186*^9}, {3.608611559284117*^9, 3.608611602233291*^9}, {
   3.608611728056993*^9, 3.608611737952961*^9}, {3.608611818192796*^9, 
   3.608611913146145*^9}, {3.608612035563623*^9, 3.608612040075717*^9}, {
   3.608612082260303*^9, 3.608612086724276*^9}, {3.608612189683255*^9, 
   3.608612200467055*^9}, {3.608612782178492*^9, 3.608612794017175*^9}, {
   3.608620659913862*^9, 3.608620668882215*^9}, {3.608621036314179*^9, 
   3.608621040234638*^9}, {3.608622773211625*^9, 3.60862277537058*^9}, {
   3.608627053309063*^9, 3.608627054196267*^9}, {3.608627214324892*^9, 
   3.608627226917143*^9}, {3.608714026037231*^9, 3.608714080527099*^9}, {
   3.608714121575514*^9, 3.60871417508723*^9}, {3.608715649368381*^9, 
   3.608715670087281*^9}, {3.608910561130711*^9, 3.608910565853859*^9}, {
   3.608912307290957*^9, 3.608912414003964*^9}, {3.608912539531743*^9, 
   3.608912545796684*^9}, {3.608914538789925*^9, 3.608914540172478*^9}, {
   3.608914576092439*^9, 3.608914613156367*^9}, {3.608914886484644*^9, 
   3.608914938798781*^9}, {3.608915090277653*^9, 3.608915092837816*^9}, {
   3.608915284316372*^9, 3.608915326923469*^9}, {3.608915359434119*^9, 
   3.608915374257162*^9}, {3.608915448226431*^9, 3.608915467023007*^9}, {
   3.608915503238518*^9, 3.608915535467554*^9}, {3.60891561530319*^9, 
   3.608915671981294*^9}, {3.608915703844231*^9, 3.60891594650987*^9}, {
   3.608915984925527*^9, 3.6089161707887*^9}, {3.608916289693655*^9, 
   3.608916341556528*^9}, {3.608916377524276*^9, 3.608916424932369*^9}, {
   3.608916462124894*^9, 3.608916611096271*^9}, {3.608916788642134*^9, 
   3.608916927575115*^9}, {3.608916965016016*^9, 3.608917020133943*^9}, 
   3.608919635615201*^9}]
},
WindowSize->{927, 1027},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 7452, 186, 541, "Input"]
}
]
*)

(* End of internal cache information *)
